<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0">
    <title>Solar Charts - Test</title>
    <style>
        body{font-family:-apple-system,system-ui,Arial;background:#111;color:#eee;margin:10px;padding:0}
        .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
        h1{font-size:24px;margin:10px 0}
        .btn{border:1px solid #445;background:#223;color:#dbe7ff;border-radius:10px;padding:14px 18px;cursor:pointer;text-decoration:none;font-size:15px;font-weight:600}
        .card{margin-top:14px;background:#1a1a2e;border:1px solid #333;border-radius:14px;padding:20px;position:relative}
        .tabs{display:flex;gap:8px;margin:8px 0}
        .tab{padding:10px 14px;border:1px solid #3a3964;border-radius:10px;cursor:pointer;background:#2a2a4a;font-size:14px}
        .tab.active{background:#334;border-color:#556}
        .toggle-container{display:flex;justify-content:flex-end;margin-bottom:10px;align-items:center;gap:10px}
        .toggle-label{color:#7fbfff;font-size:14px}
        .toggle-switch{position:relative;width:60px;height:28px;background:#23335e;border-radius:14px;cursor:pointer;transition:background 0.3s}
        .toggle-switch.active{background:#3aa2ff}
        .toggle-slider{position:absolute;top:3px;left:3px;width:22px;height:22px;background:#fff;border-radius:11px;transition:left 0.3s}
        .toggle-switch.active .toggle-slider{left:35px}
        canvas{width:100%;height:350px;background:#0f1730;border:1px solid #23335e;border-radius:10px;display:block}
        .legend{margin-top:8px;color:#bcd0ff;font-size:13px}
        .loading-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(26,26,46,0.95);display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:14px;z-index:1000}
        .spinner{border:3px solid #23335e;border-top:3px solid #3aa2ff;border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite}
        @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
        .loading-text{color:#7fbfff;margin-top:20px;font-size:16px}
        .loading-progress{color:#5a8fd8;margin-top:10px;font-size:13px}
        .hidden{display:none}
    </style>
</head>
<body>
    <div class="header">
        <h1>Solar Charts - Test</h1>
        <a href="/" class="btn">Back to Live</a>
    </div>
    <div class="card">
        <div class="tabs">
            <div id="tab-hourly" class="tab active" onclick="switchTab('hourly')">Hourly</div>
            <div id="tab-daily" class="tab" onclick="switchTab('daily')">Daily (7d)</div>
            <div id="tab-weekly" class="tab" onclick="switchTab('weekly')">Weekly</div>
            <div id="tab-monthly" class="tab" onclick="switchTab('monthly')">Monthly</div>
        </div>
        <div class="toggle-container" id="toggleContainer" style="display:none;">
            <span class="toggle-label">Show Cumulative</span>
            <div class="toggle-switch" id="cumulativeToggle" onclick="toggleCumulative()">
                <div class="toggle-slider"></div>
            </div>
        </div>
        <canvas id="chart"></canvas>
        <div class="legend" id="legendText">Test Mode - No Data</div>
    </div>
<script>
let showCumulative=false;
let currentTab='hourly';
let cvs=document.getElementById('chart');
let ctx=cvs.getContext('2d');

function toggleCumulative(){
  showCumulative = !showCumulative;
  const toggle = document.getElementById('cumulativeToggle');
  if(showCumulative){
    toggle.classList.add('active');
  }else{
    toggle.classList.remove('active');
  }
  alert('Toggle clicked! Cumulative mode: ' + showCumulative);
}

function switchTab(t){
  currentTab=t;
  ['hourly','daily','weekly','monthly'].forEach(n=>{
    const e=document.getElementById('tab-'+n);
    if(e)e.className='tab';
  });
  const at=document.getElementById('tab-'+t);
  if(at)at.className='tab active';

  // Show/hide toggle based on tab
  const toggleContainer=document.getElementById('toggleContainer');
  if(t==='hourly'){
    toggleContainer.style.display='none';
    document.getElementById('legendText').textContent='Hourly Chart (toggle hidden)';
  }else{
    toggleContainer.style.display='flex';
    document.getElementById('legendText').textContent=t.charAt(0).toUpperCase() + t.slice(1) + ' Chart (toggle visible)';
  }
}

// Test initialization
document.getElementById('legendText').textContent='Hourly Chart (toggle hidden)';
</script>
</body>
</html>